# Операции с проектом

> Этот файл содержит высокоуровневое описание операций.
> Для конкретных команд см. документацию для разработчиков.

---

## Локальная разработка

### Установка зависимостей
```bash
npm install
```

### Настройка окружения
- Скопировать `.env.example` в `.env`
- Настроить переменные окружения под локальное окружение
- База данных: SQLite (создаётся автоматически)

### Запуск в режиме разработки
```bash
npm run dev
```

### Запуск тестов
```bash
npm test
```

---

## Production операции

### Управление сервисом

**Доступные операции:**
- Проверка статуса сервиса
- Запуск сервиса
- Остановка сервиса
- Перезапуск сервиса
- Просмотр логов в реальном времени

**Детали:** См. документацию для разработчиков

---

### Обновление кода

**Процесс:**
1. Закоммитить изменения локально
2. Отправить изменения на GitHub
3. Получить изменения на сервере
4. Установить новые зависимости (если есть)
5. Перезапустить сервис
6. Проверить логи

**Детали:** См. [WORKFLOWS.md](WORKFLOWS.md)

---

### Миграции базы данных

**Типы миграций:**
- Добавление таблиц
- Изменение схемы таблиц
- Добавление/удаление колонок
- Изменение индексов

**Процесс:**
1. Создать скрипт миграции
2. Протестировать локально
3. Сделать бэкап БД на продакшене
4. Применить миграцию
5. Проверить целостность данных
6. Перезапустить сервис

**Расположение скриптов:** `services/eckwms-global/scripts/`

**Детали:** См. [WORKFLOWS.md](WORKFLOWS.md) → Процесс 2

---

### Бэкапы базы данных

**Рекомендации:**
- Делать бэкап перед каждой миграцией
- Регулярные автоматические бэкапы
- Хранить бэкапы в безопасном месте

**База данных:**
- **Development:** SQLite (файл базы данных)
- **Production:** PostgreSQL

---

## Мониторинг

### Health Checks

**Эндпоинты:**
- `/ECK/HEALTH` - Проверка работоспособности сервиса

**Что проверяется:**
- Доступность сервиса
- Подключение к БД
- Статус основных компонентов

---

### Логи

**Типы логов:**
- **Application logs** - Логи приложения
- **Error logs** - Логи ошибок
- **Access logs** - Логи доступа (Nginx)
- **PM2 logs** - Логи процессов

**Уровни логирования:**
- ERROR - Критические ошибки
- WARN - Предупреждения
- INFO - Информационные сообщения
- DEBUG - Отладочная информация (только development)

---

### Системный мониторинг

**Метрики:**
- CPU usage
- Memory usage
- Disk space
- Network activity
- Process uptime

**Инструменты:**
- PM2 monitoring
- System monitoring tools

---

## Troubleshooting

### Типичные проблемы

**Сервис не запускается:**
- Проверить логи ошибок
- Проверить порт (занятость)
- Проверить подключение к БД
- Проверить конфигурацию

**База данных недоступна:**
- Проверить статус БД сервера
- Проверить credentials
- Проверить сетевое подключение

**API не отвечает:**
- Проверить статус сервиса
- Проверить веб-сервер (Nginx)
- Проверить firewall правила
- Проверить сетевую доступность

**Детали и решения:** Документация для разработчиков содержит конкретные команды и решения.

---

## Git Workflow

### Ветки

**Основная ветка:**
- `main` - Production-ready код

**Рабочий процесс:**
1. Разработка на локальной машине
2. Коммит изменений
3. Push на GitHub
4. Pull на production сервере
5. Перезапуск сервиса

### Best Practices

**Коммиты:**
- Понятные сообщения
- Атомарные изменения
- Регулярные коммиты

**Безопасность:**
- Не коммитить `.env` файлы
- Не коммитить credentials
- Не коммитить бинарные файлы
- Не коммитить логи

---

## Окружения

### Development (Локальная разработка)

**Характеристики:**
- SQLite база данных
- Debug режим
- Hot reload
- GUI доступен (Electron)
- Детальные логи

**Когда использовать:**
- Разработка новых фич
- Тестирование изменений
- Отладка

---

### Production (Сервер)

**Характеристики:**
- PostgreSQL база данных
- Production режим
- PM2 process manager
- Nginx reverse proxy
- Headless (без GUI)
- Оптимизированные логи

**Когда использовать:**
- Деплой готовых фич
- Production-ready код
- Реальные пользователи

---

## Безопасность

### Best Practices

**Credentials:**
- Хранить в `.env` файлах
- Не коммитить в git
- Использовать сильные пароли
- Регулярно обновлять

**API Security:**
- Аутентификация через API keys
- HTTPS для production
- Валидация входных данных
- Rate limiting

**Server Security:**
- Firewall правила
- SSH ключи (не пароли)
- Регулярные обновления
- Мониторинг доступа

---

## Делегирование

### Для Архитектора (планирование)

Этот файл предоставляет обзор операций для планирования:
- Какие операции доступны
- Какие процессы существуют
- Какие окружения используются

### Для Кодера (выполнение)

Кодер использует детальную документацию с конкретными командами:
- **QUICK_REFERENCE.md** - Быстрая справка с командами
- **SERVER_ACCESS.md** - Детали доступа к серверу
- **REMOTE_DEVELOPMENT.md** - Workflow разработки

---

## См. также

- [WORKFLOWS.md](WORKFLOWS.md) - Детальные рабочие процессы
- [ARCHITECTURE.md](ARCHITECTURE.md) - Архитектура системы
- [STACK.md](STACK.md) - Технологический стек
- [DELEGATION_GUIDE.md](DELEGATION_GUIDE.md) - Руководство по делегированию

**Для конкретных команд и деталей:**
- QUICK_REFERENCE.md (в корне проекта)
- SERVER_ACCESS.md (конфиденциально)
- REMOTE_DEVELOPMENT.md (конфиденциально)
